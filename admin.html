<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Rb_buy — Admin</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#0b1b2b;color:#eaf6ff;margin:0;padding:20px}
.container{max-width:1100px;margin:0 auto}
.header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.btn{background:#00d9ff;color:#001022;padding:8px 12px;border-radius:8px;border:0;cursor:pointer}
.table{width:100%;border-collapse:collapse;margin-top:12px}
.table th, .table td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.04);text-align:left}
.input{padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#eaf6ff}
.note{color:#9fb6c9;margin-top:8px}
.smallbtn{padding:6px 8px;border-radius:6px;border:0;cursor:pointer}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h2>Admin — Заявки</h2>
    <div>
      <input id="adminPass" class="input" placeholder="Админ-пароль" style="margin-right:8px">
      <button id="adminLogin" class="btn">Войти</button>
      <button id="adminLogout" class="btn" style="background:#334455;margin-left:8px">Выйти</button>
    </div>
  </div>

  <div id="adminArea" style="display:none">
    <div class="note">Пароль по умолчанию для демо: <b>admin123</b>.</div>
    <table class="table">
      <thead>
        <tr><th>ID</th><th>Пользователь</th><th>Email</th><th>Robux</th><th>Сумма</th><th>Статус</th><th>Действия</th></tr>
      </thead>
      <tbody id="ordersTbody"></tbody>
    </table>
  </div>

  <div id="anonNote" class="note">Для просмотра заявок войдите как админ.</div>
</div>

<script>
const ADMIN_PASS = 'admin123';
function loadOrders(){ return JSON.parse(localStorage.getItem('rb_orders')||'[]'); }
function saveOrders(o){ localStorage.setItem('rb_orders', JSON.stringify(o)); }

function render(){
  const tb = document.getElementById('ordersTbody');
  tb.innerHTML = '';
  const orders = loadOrders();
  if(!orders.length){ tb.innerHTML = '<tr><td colspan="7" style="color:#9fb6c9">Заявок нет</td></tr>'; return; }
  orders.forEach(o=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${o.id}</td><td>${o.name}</td><td>${o.email}</td><td>${o.robux}</td><td>${o.price} ₽</td><td>${o.status}</td><td>${renderActions(o)}</td>`;
    tb.appendChild(tr);
  });
}

function renderActions(o){
  if(o.status === 'awaiting_payment') return `<button class="smallbtn" onclick="markPaid('${o.id}')">Подтвердить оплату</button>`;
  if(o.status === 'paid') return `<button class="smallbtn" onclick="markSent('${o.id}')">Отправлено</button>`;
  return '—';
}

function markPaid(id){
  const orders = loadOrders(); const o = orders.find(x=>x.id===id); if(!o)return;
  o.status='paid'; o.paid_at = new Date().toISOString(); saveOrders(orders); render();
  alert('Оплата отмечена как полученная.');
}
function markSent(id){
  const orders = loadOrders(); const o = orders.find(x=>x.id===id); if(!o)return;
  o.status='sent'; o.sent_at = new Date().toISOString(); saveOrders(orders); render();
  alert('Заказ помечен как отправленный.');
}

document.getElementById('adminLogin').addEventListener('click', ()=>{
  const v = document.getElementById('adminPass').value;
  if(v === ADMIN_PASS){ document.getElementById('adminArea').style.display='block'; document.getElementById('anonNote').style.display='none'; render(); }
  else alert('Неверный пароль');
});
document.getElementById('adminLogout').addEventListener('click', ()=>{ document.getElementById('adminArea').style.display='none'; document.getElementById('anonNote').style.display='block'; });

render();
</script>
</body>
</html>
